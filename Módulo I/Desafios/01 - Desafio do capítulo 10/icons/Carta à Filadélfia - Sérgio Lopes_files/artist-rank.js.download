vgl.plugin.func("artistRank",[function(){var t=this,e=document.getElementById("rankUpDown"),n=null,o=1,i=[];function r(t){t?n=vgl.modal.open("rank"):n&&(n.cancel(),n=null)}function l(t){if(void 0!==i[o])return!1;if(i[o]=!0,!e){var n=vgl.element("button",{type:"button",class:"close icon-close",onclick:function(){r(!1)}});(e=vgl.element("ul",{id:"rankUpDown"})).appendChild(n),document.body.appendChild(e)}window.ajax({url:"https://app2.vagalume.com.br/ajax/rank.php?action=getArtists&page="+o,dataType:"json",beforeSend:function(t){vgl.write(function(){e.classList.add("rankLoading")})},error:function(t){vgl.write(function(){e.innerHTML='<li class="error">Erro na requisição :(</li>'})},success:function(e){t(e)},complete:function(t){vgl.write(function(){e.classList.remove("rankLoading")})}})}function a(){e=document.getElementById("rankUpDown"),void 0!==t.getAttribute("ref")?window.ajax({url:"https://api.vagalume.com.br/rankArtist.php?apikey=ea5341a032b87a7818e2116fd406c6fa&period=monthly&artID="+t.getAttribute("ref"),success:function(e){void 0!==e.artist?(t.setAttribute("for",e.artist.month[e.artist.month.length-1].pos),t.innerHTML=e.artist.month[e.artist.month.length-1].pos+"º",t.style.display="block"):t.style.display="block"}}):t.style.display="block",t.addEventListener("click",function(){var t=this.getAttribute("for");t>=100&&(o=t%100==0?parseInt(t/100):parseInt(t/100)+1),l(function(n){!function t(n,i,r=!1){"string"==typeof n&&(n=JSON.parse(n));for(var a=n.length,s=vgl.element("div",{for:o}),c="",d=0;d<a;d++){c=n[d].realPos==i?"active":"";var u=vgl.element("li",{class:"borderless "+c+" digit"+n[d].realPos.toString().length,href:"/"+n[d].bandPath+"/",html:'<div class="topPosition"><p class="w1">'+n[d].realPos+'º</p></div><div class="cardCenterCol"><div class="topInfo"><picture class="topPic circle"><source srcset="/'+n[d].bandPath+"/images/"+n[d].bandPath+'.webp" type="image/webp"><img src="/'+n[d].bandPath+"/images/"+n[d].bandPath+'.jpg" /></picture><div><strong class="w1 h22">'+n[d].bandName+"</strong></div></div></div>",onclick:function(){window.location.href=this.getAttribute("href")}});s.appendChild(u)}var p=e.querySelector(".loading");p&&p.remove();var f=e.querySelector(".error");f&&f.remove(),r?"down"==r?e.appendChild(s):"up"==r&&(e.insertBefore(s,e.firstChild),e.scrollTop=e.querySelector('div[for="'+(o+1)+'"]').offset().top-50):(e.appendChild(s),vgl.write(function(){var t=e.querySelector("li.active");t&&(e.scrollTop=0,e.scrollTop=t.offset().top-window.innerHeight/2,e.setAttribute("style","display: block;scroll-behavior: smooth; -webkit-overflow-scrolling: touch;"))}));var v=!1;e.addEventListener("scroll",function(){clearTimeout(v),v=setTimeout(function(){var n=e.scrollTop/e.scrollHeight*100;if(n>90&&(o=parseInt(e.querySelector("div[for]:last-child").getAttribute("for"))+1,l(function(e){t(e,!1,"down")})),n<10){var i=parseInt(e.querySelector("div[for]:first-child").getAttribute("for"));i>1&&(o=i-1,l(function(e){t(e,!1,"up")}))}},350)},!1)}(n,t)}),r(!0)},!1)}vgl.modal.config("rank",{onOpen:function(t){vgl.write(function(){e.style.display="block"})},onClose:function(){vgl.write(function(){e&&(e.remove(),e=null)})}}),document.addEventListener("keyup",function(t){27==t.keyCode&&r(!1)},!1),window.addEventListener("histDocReady",function(){r(!1),a()},!1),a()}]);